:root{
  /* Цвета */
  --bg:#F8F9FA; --surface:#FFFFFF; --text:#212529; --muted:#6C757D;
  --border:#E9ECEF; --divider:#DEE2E6;
  --accent:#00B39E; --success:#28A745; --warning:#FFC107; --danger:#DC3545; --blue:#4A89F3;
  --footer-bg:#4D5964;

  /* Тени/радиусы/отступы */
  --shadow:0 1px 2px rgba(16,24,40,.06),0 1px 1px rgba(16,24,40,.04);
  --r-6:6px; --r-8:8px; --r-10:10px; --r-12:12px; --r-pill:999px;
  --sp-4:4px; --sp-6:6px; --sp-8:8px; --sp-10:10px; --sp-12:12px; --sp-16:16px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol",sans-serif;
  color:var(--text); background:var(--bg);
}

/* Header */
.main-header{
  position:sticky; top:0; z-index:1000;
  display:flex; align-items:center; gap:var(--sp-16);
  background:var(--surface); border-bottom:1px solid var(--border);
  box-shadow:0 1px 0 #00000000; padding:10px var(--sp-16);
}
.icon-button{
  background:transparent; border:1px solid var(--border); width:38px; height:38px;
  border-radius:var(--r-8); display:grid; place-items:center; cursor:pointer; color:var(--muted);
}
.icon-button i, .icon-button svg{width:20px; height:20px}
.icon-button:hover{background:rgb(243, 244, 246)}
.title-container{display:flex; align-items:center; gap:12px; min-width:0}
.main-icon{width:28px; height:28px; color:var(--accent)}
.title-container i[data-lucide], .title-container svg.lucide{width:28px; height:28px}
.titles{display:flex; flex-direction:column; min-width:0}
.page-title{margin:0; font-size:18px; font-weight:700; color:var(--accent)}
.subtitle{margin:0; font-size:13px; color:var(--muted)}
.user-area{margin-left:auto; position:relative}
.avatar-button{
  display:flex; align-items:center; gap:var(--sp-8);
  background:var(--surface); border:1px solid var(--border);
  padding:var(--sp-4) var(--sp-8); border-radius:var(--r-pill); cursor:pointer;
}
.avatar-button img{width:28px; height:28px; border-radius:50%}
.avatar-button .chevron{width:18px; height:18px; color:var(--muted)}
.avatar-button .chevron svg{width:18px; height:18px}
.user-menu{
  position:absolute; right:0; top:calc(100% + 8px);
  background:var(--surface); border:1px solid var(--border); border-radius:var(--r-10);
  box-shadow:var(--shadow); min-width:200px; padding:var(--sp-6); display:none;
}
.user-menu.open{display:block}
.user-menu__item{
  width:100%; display:flex; align-items:center; gap:var(--sp-8);
  padding:var(--sp-8) var(--sp-10); border:none; background:transparent; cursor:pointer; border-radius:var(--r-8);
}
.user-menu__item:hover{background:#f6f7f9}

/* Layout / Sidebar */
.layout{display:flex; min-height:calc(100vh - 64px - 56px)}
.sidebar{
  width:260px; background:var(--surface); border-right:1px solid var(--border);
  padding:12px var(--sp-8); transition:width .2s ease;
}
body.sidebar-collapsed .sidebar{width:72px}
.nav{display:flex; flex-direction:column; gap:6px}
.nav-item{
  display:flex; align-items:center; gap:12px; padding:10px 12px;
  border-radius:10px; color:#495057; text-decoration:none;
}
.nav-item i, .nav-item svg{width:20px; height:20px}
.nav-item:hover{background:#f3f4f6}
.nav-item.active{background:var(--accent); color:#fff}
.nav-item.active i, .nav-item.active svg{color:#fff}
body.sidebar-collapsed .nav-item span{display:none}
body.sidebar-collapsed .nav-item{justify-content:center}

/* Content & Grid */
.content{flex:1; padding:var(--sp-16)}
.widgets-grid{
  display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:var(--sp-16);
}

/* Cards */
.card{
  display:flex; flex-direction:column; background:var(--surface);
  border:1px solid var(--border); border-radius:var(--r-12); box-shadow:var(--shadow);
  padding:14px; text-decoration:none; color:inherit; transition:transform .12s ease, box-shadow .12s ease; cursor:pointer;
}
.card:hover{transform:translateY(-1px); box-shadow:0 4px 10px rgba(16,24,40,.08)}
.card-header{margin-bottom:10px}
.card-title{margin:0; font-size:16px; font-weight:700; color:#2b2f33}
.card-subtitle{margin:2px 0 0; font-size:12px; color:var(--muted)}
.card-chart{width:100%; height:240px; display:flex; align-items:center; justify-content:center}
.card-actions{margin-top:auto; display:flex; justify-content:flex-end}

/* KPI */
.kpi-row{margin-bottom:8px}
.kpi-card .kpi-value{font-size:24px; font-weight:700; color:#2b2f33; margin-top:6px}
.kpi-value.positive{color:var(--success)}

/* Buttons */
.btn{display:inline-flex; align-items:center; gap:var(--sp-8); font-weight:600; border-radius:var(--r-8); cursor:pointer}
.btn i, .btn svg{width:18px; height:18px}
.btn-primary{background:var(--accent); color:#fff; border:none; padding:8px 12px}
.btn-primary:hover{filter:brightness(.95)}
.btn-link{background:transparent; border:none; color:var(--accent); padding:6px 8px}
.btn-link:hover{text-decoration:underline}

/* Footer */
.main-footer{
  height:45px; display:flex; align-items:center; justify-content:space-between;
  padding:0 var(--sp-16); background:var(--footer-bg); color:#fff; font-family:"Helvetica Neue", cursive;
}
.main-footer i, .main-footer svg{width:18px; height:18px}
.footer-left,.footer-right{display:flex; align-items:center; gap:var(--sp-8)}

/* -------- Org page -------- */
.data-card{
  background:var(--surface); border:1px solid var(--border); border-radius:var(--r-12);
  box-shadow:var(--shadow); padding:var(--sp-12);
}
.org-page .card-header{display:flex; align-items:center; justify-content:space-between; gap:var(--sp-8)}
.org-page .card-title{color:var(--blue)} /* синий заголовок страницы */
.org-page .org-title{display:flex; align-items:center; gap:8px; color:var(--blue)}
.org-page .org-title i, .org-page .org-title svg{width:20px; height:20px}
.org-page .card-subtitle{margin-left:28px}
.org-actions{display:flex; align-items:center; gap:var(--sp-12)}
.view-toggle.segmented{
  display:inline-flex; border:1px solid var(--border); border-radius:var(--r-10); overflow:hidden; background:#fff;
}
.view-toggle .seg-btn{
  padding:8px 12px; border:none; background:#fff; cursor:pointer; color:#495057; font-weight:600;
}
.view-toggle .seg-btn + .seg-btn{border-left:1px solid var(--border)}
.view-toggle .seg-btn.active{background:var(--accent); color:#fff}
.org-search{border:1px solid var(--border); border-radius:var(--r-10); padding:8px 12px; min-width:280px; background:#fff}

/* ---------- Org list (cards) ---------- */
.org-list{display:flex; flex-direction:column; gap:10px}
.org-item{
  --wBase:90; --w:var(--wBase); --scale:.8; --indent:0px;
  width:calc(var(--w) * var(--scale) * 1%); margin-left:calc((var(--wBase) - (var(--w) * var(--scale))) * 1%); padding-left:var(--indent);
  position:relative; background:#F2F2F2; border:2.25px solid var(--border);
  border-radius:var(--r-12); box-shadow:var(--shadow); padding:7px 10px 21px;
  transition:transform .12s ease, box-shadow .12s ease, border-color .2s ease, width .2s ease, margin-left .2s ease; cursor:pointer;
}
.org-item:hover{transform:translateY(-1px); box-shadow:0 4px 10px rgba(16,24,40,.08)}
.org-item .row{display:flex; align-items:center; gap:var(--sp-8); min-height:20px}
.org-item .name{margin:0; font-weight:700; color:#2b2f33; font-size:13px; display:inline-flex; align-items:center}
.org-item .name i, .org-item .name svg{width:21px; height:21px; margin-right:8px}
.org-item .emp-pill{
  position:absolute; right:10px; bottom:6px; font-size:12px; color:#2b2f33;
  background:#f8f9fa; border:1px solid var(--border); border-radius:var(--r-pill); padding:2px 7px;
}
.org-item.depth-0{--w:90; --indent:0}
.org-item.depth-1{--w:90; --indent:16px}
.org-item.depth-2{--w:72; --indent:24px}
.org-item.depth-3{--w:57.6; --indent:36px}
.org-item.depth-4{--w:46.08; --indent:48px}

/* ---------- Org table ---------- */
.org-table-toolbar{display:flex; flex-wrap:wrap; align-items:center; gap:var(--sp-8); margin-bottom:10px}
.org-table-toolbar .btn{padding:6px 10px; border:1px solid var(--border); background:#fff; color:#2b2f33}
.org-table-toolbar .btn:hover{background:#f6f7f9}
.org-table-toolbar .select,.org-table-toolbar .input{
  border:1px solid var(--border); border-radius:var(--r-8); padding:6px 10px; background:#fff
}
.org-table-wrap{background:#fff; border:1px solid var(--border); border-radius:var(--r-12); box-shadow:var(--shadow); overflow:auto}
.org-table{width:100%; border-collapse:collapse; min-width:720px}
.org-table th,.org-table td{
  padding:10px 12px; border-bottom:1px solid var(--divider); text-align:left; font-size:14px; color:#2b2f33
}
.org-table thead th{position:sticky; top:0; z-index:1; background:var(--blue); color:#fff; font-weight:700}

/* Hover по строке: #F2F2F2; текст остаётся тёмным */
.org-table tbody tr:hover{background:#F2F2F2}
.org-table tbody tr:hover td{color:inherit}

/* Ячейка дерева + caret */
.tree-cell{display:flex; align-items:center; gap:12px}
.tree-indent{display:inline-block; width:calc(var(--depth,0) * 16px); height:1px}
.tree-caret{
  width:16px; height:16px; display:grid; place-items:center; flex:0 0 16px;
  border:1px solid var(--blue); border-radius:var(--r-6); background:#fff; color:var(--blue); cursor:pointer;
}
.tree-caret[disabled]{opacity:.45; cursor:default; background:#f8f9fa; border-color:var(--border); color:var(--muted)}
.tree-caret svg{width:14px; height:14px}
.org-table tbody tr:hover .tree-caret{border-color:var(--blue); color:var(--blue); background:#fff}